function _typeof(a){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(a,b){if("function"==typeof define&&define.amd){define ("mod_treasurehunt/ol3-layerswitcher",["mod_treasurehunt/ol"],b)}else if("object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports){module.exports=b(require("mod_treasurehunt/ol"))}else{a.LayerSwitcher=b(a.ol)}})(this,function(a){a.control.LayerSwitcher=function(b){var c=b||{},d=c.tipLabel?c.tipLabel:"Legend";this.mapListeners=[];this.hiddenClassName="ol-unselectable ol-control layer-switcher";if(a.control.LayerSwitcher.isTouchDevice_()){this.hiddenClassName+=" touch"}this.shownClassName="shown";var e=document.createElement("div");e.className=this.hiddenClassName;var f=document.createElement("button");f.setAttribute("title",d);e.appendChild(f);this.panel=document.createElement("div");this.panel.className="panel";e.appendChild(this.panel);a.control.LayerSwitcher.enableTouchScroll_(this.panel);var g=this;f.onmouseover=function(){g.showPanel()};f.onclick=function(a){a=a||window.event;g.showPanel();a.preventDefault()};g.panel.onmouseout=function(a){a=a||window.event;if(!g.panel.contains(a.toElement||a.relatedTarget)){g.hidePanel()}};a.control.Control.call(this,{element:e,target:c.target})};a.inherits(a.control.LayerSwitcher,a.control.Control);a.control.LayerSwitcher.prototype.showPanel=function(){if(!this.element.classList.contains(this.shownClassName)){this.element.classList.add(this.shownClassName);this.renderPanel()}};a.control.LayerSwitcher.prototype.hidePanel=function(){if(this.element.classList.contains(this.shownClassName)){this.element.classList.remove(this.shownClassName)}};a.control.LayerSwitcher.prototype.renderPanel=function(){this.ensureTopVisibleBaseLayerShown_();while(this.panel.firstChild){this.panel.removeChild(this.panel.firstChild)}var a=document.createElement("ul");this.panel.appendChild(a);this.renderLayers_(this.getMap(),a)};a.control.LayerSwitcher.prototype.setMap=function(b){for(var c=0;c<this.mapListeners.length;c++){a.Observable.unByKey(this.mapListeners[c])}this.mapListeners.length=0;a.control.Control.prototype.setMap.call(this,b);if(b){var d=this;this.mapListeners.push(b.on("pointerdown",function(){d.hidePanel()}));this.renderPanel()}};a.control.LayerSwitcher.prototype.ensureTopVisibleBaseLayerShown_=function(){var b;a.control.LayerSwitcher.forEachRecursive(this.getMap(),function(a){if("base"===a.get("type")&&a.getVisible()){b=a}});if(b){this.setVisible_(b,!0)}};a.control.LayerSwitcher.prototype.setVisible_=function(b,c){var d=this.getMap();b.setVisible(c);if(c&&"base"===b.get("type")){a.control.LayerSwitcher.forEachRecursive(d,function(a){if(a!=b&&"base"===a.get("type")){a.setVisible(!1)}})}};a.control.LayerSwitcher.prototype.renderLayer_=function(b){var c=this,d=document.createElement("li"),e=b.get("title"),f=a.control.LayerSwitcher.uuid(),g=document.createElement("label");if(b.getLayers&&!b.get("combine")){d.className="group";g.innerHTML=e;d.appendChild(g);var h=document.createElement("ul");d.appendChild(h);this.renderLayers_(b,h)}else{d.className="layer";var i=document.createElement("input");if("base"===b.get("type")){i.type="radio";i.name="base"}else{i.type="checkbox"}i.id=f;i.checked=b.get("visible");i.onchange=function(a){c.setVisible_(b,a.target.checked)};d.appendChild(i);g.htmlFor=f;g.innerHTML=e;var j=this.getMap().getView().getResolution();if(j>b.getMaxResolution()||j<b.getMinResolution()){g.className+=" disabled"}d.appendChild(g)}return d};a.control.LayerSwitcher.prototype.renderLayers_=function(a,b){for(var c=a.getLayers().getArray().slice().reverse(),d=0,e;d<c.length;d++){e=c[d];if(e.get("title")){b.appendChild(this.renderLayer_(e,d))}}};a.control.LayerSwitcher.forEachRecursive=function(b,c){b.getLayers().forEach(function(b,d,e){c(b,d,e);if(b.getLayers){a.control.LayerSwitcher.forEachRecursive(b,c)}})};a.control.LayerSwitcher.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=0|16*Math.random(),c="x"==a?b:8|3&b;return c.toString(16)})};a.control.LayerSwitcher.enableTouchScroll_=function(b){if(a.control.LayerSwitcher.isTouchDevice_()){var c=0;b.addEventListener("touchstart",function(a){c=this.scrollTop+a.touches[0].pageY},!1);b.addEventListener("touchmove",function(a){this.scrollTop=c-a.touches[0].pageY},!1)}};a.control.LayerSwitcher.isTouchDevice_=function(){try{document.createEvent("TouchEvent");return!0}catch(a){return!1}};var b=a.control.LayerSwitcher;return b});
//# sourceMappingURL=ol3-layerswitcher.min.js.map
